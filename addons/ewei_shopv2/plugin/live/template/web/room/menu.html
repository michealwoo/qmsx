<style>
    .live-menu-ul{position: relative;}
    .live-menu-ul li{position: relative;float:left;padding:0 8px 0 0;}
    .live-menu-ul li a{width:100px;height:35px;color:#3f3f3f;background: #fff;display: block;text-align: center;line-height: 33px;font-size:14px;-webkit-border-radius: 3px;-moz-border-radius: 3px;border-radius: 3px;border:1px solid #ddd;}
    .live-menu-ul li a.add{background: #1ab394;color:#fff;border:none;line-height: 35px;}
    .live-menu-ul li.active a{background: #fff;border:1px solid #1ab394;}
    .live-menu-ul li span{position: absolute;right:7px;top:12px;background: #ff0000;-webkit-border-radius: 16px;border-radius: 16px;width:16px;height:16px;display: inline-block;line-height: 14px;color:#fff;font-weight:normal;display: none;}
    .live-menu-ul li span i.fa-close:before{font-weight: normal;margin:0 0 0 1px;}

    .live-munu-tab{border:1px solid #efefef;}
    .live-menu-tab-title{height:42px;border-bottom:1px solid #efefef;color:#3f3f3f;background: #f5f5f6;padding:0 20px;line-height: 42px;}
    .live-menu-tab-info{padding:20px;}
    .live-menu-info{display: none;}
    .dd-handle{margin:0;padding:0;}

    .diy-phone{float: left;width: 328px;height: auto;border: 1px solid #ddd;border-radius: 10px;background: #fff;padding: 10px;overflow: hidden;margin-bottom: 50px;}
    .diy-phone .phone-head{height: 44px;background: #fff;position: relative;}
    .diy-phone .phone-head:before{content: "";position: absolute;top: 15px;left: 112px;height: 8px;width: 8px;background: #ddd;border-radius: 8px;}
    .diy-phone .phone-head:after{content: "";position: absolute;top: 15px;left: 128px;height: 8px;width: 50px;background: #ddd;border-radius: 8px;}
    .diy-phone .phone-title{height: 53px;background: url("../addons/ewei_shopv2/plugin/live/static/images/wx-top.png") 0 0 no-repeat;background-size: 100% auto;padding: 0 50px;font-size: 15px;color: #fff;text-align: center;line-height: 68px;cursor: default;overflow: hidden;display:block;white-space:nowrap;text-overflow:ellipsis;}
    .diy-phone .phone-main{background: #f5f5f5;min-height: 400px;border: 1px solid #ddd;border-top: 0;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}
    .diy-phone .phone-main p{margin: 0;padding: 0;}
    .diy-phone .phone-main .highlight{height: 50px;border: 1.5px dashed #999;text-align: center;font-size: 12px;color: #999;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;}
    .diy-phone .phone-main .drag{position: relative;min-height: 20px;display: block;overflow: hidden;}
    .diy-phone .phone-main .drag.selected:before,
    .diy-phone .phone-main .drag:hover:before{content: "";position: absolute;top: 0;left: 0;right: 0;bottom: 0;border: 2px dashed #00a0e9;cursor: move;z-index: 10;}
    .diy-phone .phone-main .drag.fixed:before{cursor: default;}
    .diy-phone .phone-main .drag .btn-edit-del{height: 16px;position: absolute;right: 2px;bottom: 2px;display: none;}
    .diy-phone .phone-main .drag .btn-edit-del > div{width: 32px;height: 16px;line-height: 16px;display: inline-block;text-align: center;font-size: 10px;color: #fff;background: rgba(0,0,0,.4);margin-left: 2px;cursor: pointer;position: relative;z-index: 11;}
    .diy-phone .phone-main .drag.selected .btn-edit-del ,
    .diy-phone .phone-main .drag:hover .btn-edit-del{display: block;}
    .diy-phone .phone-main .drag.nodelete .btn-edit-del .btn-del{display: none;}
    .diy-phone .phone-main a{color: #337ab7;}
    .diy-phone .phone-foot{height: 24px;width: 60px;margin: 15px auto 5px;border: 1px solid #ddd;border-radius: 5px;}
    .diy-editor{float: left; width: 494px; height: auto; background: #fdfdfd; padding: 15px 10px; margin-left: 18px; border: 1px solid #ddd; border-radius: 5px;margin-bottom: 150px;position: relative;}
    .diy-top-menu{float: left; width: 494px; height: auto; background: #fdfdfd; padding: 10px 10px; margin-left: 18px; border: 1px solid #ddd; border-radius: 5px;margin-bottom: 10px;position: relative;margin-top: 190px;}
    .diy-editor .editor-arrow{height: 0; position: relative;}
    .diy-editor .editor-arrow:after,.diy-editor .editor-arrow:before{position: absolute; font-family: simsun; content: "◆"; top: 8px; left: -21px; display: block; width: 9px; height: 18px; font-size: 24px; color: #fdfdfd; z-index: 111;}
    .diy-editor .editor-arrow:after {left: -22px;color: #ddd;z-index: 11;}
    .diy-editor .form-group{margin: 5px 0;}
    .diy-editor .form-group .control-label{padding: 5px 0; text-align: right;}
    .diy-editor .form-group .form-control{padding: 0 5px;}

    .block-tab{height: 40px; background: #fff; display: -webkit-flex; display: -ms-flexbox; display: flex; z-index: 10;border-bottom:1px solid #eaeaea;}

    .fullscreen .block-tab{display: none;}
    .player-fullscreen .block-tab{top: 13.5rem;}
    .diy-phone .phone-main .block-tab a{width: 100%; line-height: 40px; text-align: center; font-size: 0.7rem; color: #333; -webkit-box-flex: 1; -webkit-flex: 1; -ms-flex: 1; flex: 1; overflow: hidden;position: relative;}
    .diy-phone .phone-main .block-tab a.active{color: #118cff;}
    .block-tab a.active:before{content: ''; position: absolute; left: 0.5rem; right: 0.5rem; bottom: 0; border-bottom: 2px solid #118cff;}

    .diy-editor-group .inner{display: none;}
    .nestable-list span{display: none;position: absolute;right:1px;top:-1px;height:9px;line-height: 9px;font-size:14px;font-weight: normal;}
    .content-img{display: none;}
</style>
<div class="alert alert-info">
    <p>说明:</p>
    <p>1. 默认选项卡为【直播间】、【商品】、【介绍】，不可删除。名称可以自定义，如不填写则显示默认名称。</p>
    <p>2. 最多只能显示5个菜单，在【商品】，【介绍】不显示的情况下，可以添加四个自定义菜单</p>
</div>
<div class="form-group" style="margin-left:0;margin-right: 0;">
    <div class="diy-phone">
        <div class="phone-head"></div>
        <div class="phone-body">
            <div class="phone-main" id="phone">
                <div class="phone-title">互动直播</div>
                <div>
                    <img src="../addons/ewei_shopv2/plugin/live/static/images/room/live-video.png" width="100%" alt="">
                </div>
                <div>
                    <div class="block-tab" id="sortable">
                        {loop $nestables $index $row}
                        <a href="javascript:void(0);" data-tab="{$row}" style="{if ($menu['goods']['isshow']==1 && $row=='goods')||($menu['introduce']['isshow']==1 && $row=='introduce')}display: none;{else}display: block;{/if}" class="nestable-list {$row} {if $index==0}active{/if}">
                            <input type="hidden" name="nestable[]" value="{$row}">
                            {if empty($menu[$row]['name'])}
                            {if $row=='interaction'}
                            直播间
                            {elseif $row=='goods'}
                            商品
                            {elseif $row=='introduce'}
                            介绍
                            {else}
                            自定义菜单
                            {/if}
                            {else}
                            {$menu[$row]['name']}
                            {/if}
                            {if $row!='interaction' && $row!='goods' && $row!='introduce' }
                            <span><i class="fa fa-close"></i></span>
                            {/if}
                        </a>
                        {/loop}
                    </div>
                </div>
                <div class="content">
                    <img src="../addons/ewei_shopv2/plugin/live/static/images/room/interaction.png" width="100%" alt="">
                </div>
                <div class="phone-footer">
                    <img src="../addons/ewei_shopv2/plugin/live/static/images/room/footer.png" width="100%" alt="">
                </div>
            </div>
        </div>
        <div class="phone-foot"></div>
    </div>
    <div class="diy-top-menu">
        <ul class="live-menu-ul">
            <li><a href="javascript:void(0);" class="add menu-add"><i class="fa fa-plus"></i> 添加菜单</a></li>
            <li style="{if empty($menu['goods']['isshow'])}display:none;{else}display:block;{/if}"><a href="javascript:void(0);" data-tab="goods" class="nestable-list goods">商品</a></li>
            <li style="{if empty($menu['introduce']['isshow'])}display:none;{else}display:block;{/if}"><a href="javascript:void(0);" data-tab="introduce" class="nestable-list introduce">介绍</a></li>
        </ul>
    </div>
    <div class="diy-editor">
        <div class="editor-arrow"></div>
        <div class="diy-editor-group" id="editor">
            <!--互动start-->
            <div class="inner live-menu-interaction" style="{if $nestables[0]=='interaction'}display: block;{/if}">
                <div class="form-group">
                    <div class="col-sm-2 control-label">名称</div>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                                <input type="text" name="dtab[tabtitle]" data-tab="interaction" class="live-name form-control" value="{php echo empty($menu['interaction']['name'])?'直播间':$menu['interaction']['name']}" />
                            {else}
                                <div class="form-control valid">{php echo empty($menu['interaction']['name'])?'直播间':$menu['interaction']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
            </div>
            <!--互动end-->
            <!--商品satart-->
            <div class="inner live-menu-goods" style="{if $nestables[0]=='goods'}display: block;{/if}">
                <div class="form-group">
                    <label class="col-sm-2 control-label">名称</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[goodstitle]" data-tab="goods" class="live-name form-control" value="{php echo empty($menu['goods']['name'])?'商品':$menu['goods']['name']}" />
                            <div class="input-group-addon">
                                <input type="checkbox" name="dtab[goodstitleshow]" {if empty($menu['goods']['isshow'])}checked{/if} class="" value="{if empty($menu['goods']['isshow'])}0{else}1{/if}" >  显示
                            </div>
                            {else}
                            <div class="form-control valid">{php echo empty($menu['goods']['name'])?'商品':$menu['goods']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
            </div>
            <!--商品end-->
            <!--直播间介绍start-->
            <div class="inner live-menu-introduce" style="{if $nestables[0]=='introduce'}display: block;{/if}">
                <div class="form-group">
                    <label class="col-sm-2 control-label">名称</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[introducetitle]" data-tab="introduce" class="live-name form-control" value="{php echo empty($menu['introduce']['name'])?'介绍':$menu['introduce']['name']}"  />
                            <div class="input-group-addon">
                                <input type="checkbox" name="dtab[introducetitleshow]" {if empty($menu['introduce']['isshow'])}checked{/if} class="" value="{if empty($menu['introduce']['isshow'])}0{else}1{/if}" >  显示
                            </div>
                            {else}
                            <div class="form-control valid">{php echo empty($menu['introduce']['name'])?'介绍':$menu['introduce']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">介绍</label>
                    <div class="col-sm-10 col-xs-12">
                        {ife 'live.room' $item}
                        {php echo tpl_ueditor('introduce',$item['introduce'],array('height'=>'390'))}
                        {else}
                        <textarea id='detail' style='display:none'>{$item['introduce']}</textarea>
                        <a href='javascript:preview_html("#detail")' class="btn btn-default">查看内容</a>
                        {/if}
                    </div>
                </div>
            </div>
            <!--直播间介绍end-->
            <!--自定义菜单1start-->
            <div class="inner live-menu-customname1" style="{if $nestables[0]=='customname1'}display: block;{/if}">
                <div class="form-group">
                    <label class="col-sm-2 control-label">名称</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customname1]" data-tab="customname1" class="live-name form-control" value="{if !empty($menu['customname1']['name'])}{$menu['customname1']['name']}{else}自定义{/if}"  />
                            {else}
                            <div class="form-control valid">{php echo empty($menu['customname1']['name'])?'自定义':$menu['customname1']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">类型</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype1]' data-tab="customname1" value="0" {if empty($menu['customname1']['type'])}checked{/if} /> 文本</label>
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype1]' data-tab="customname1" value="1" {if $menu['customname1']['type']==1}checked{/if} /> 链接</label>
                            {else}
                            <div class='form-control-static'>{if empty($menu['customname1']['type'])}文本{elseif $menu['customname1']['type']==1}链接{/if}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname1-type-url" style="{if $menu['customname1']['type']==1}display: block;{else}display:none;{/if}">
                    <label class="col-sm-2 control-label">链接</label>
                    <div class="col-sm-10">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customurl1]" class="form-control input-sm diy-bind" placeholder="请选择链接或输入链接地址" value="{$menu['customname1']['url']}" id="shareurl" />
                            <span data-input="#shareurl" data-toggle="selectUrl" data-full="true" class="input-group-addon btn btn-default">选择链接</span>
                            {else}
                            <div class='form-control-static'>{$menu['customname1']['url']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname1-type-content" style="{if empty($menu['customname1']['type'])}display:block;{else}display:none;{/if}">
                    <label class="col-sm-2 control-label">内容</label>
                    <div class="col-sm-10 col-xs-12">
                        {ife 'live.room' $item}
                        {php echo tpl_ueditor('dtab[customintroduce1]',$menu['customname1']['introduce'],array('height'=>'358'))}
                        {/if}
                    </div>
                </div>
            </div>
            <!--自定义菜单1end-->
            <!--自定义菜单2start-->
            <div class="inner live-menu-customname2" style="{if $nestables[0]=='customname2'}display: block;{/if}">
                <div class="form-group">
                    <label class="col-sm-2 control-label">名称</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customname2]" data-tab="customname2" class="live-name form-control" value="{if !empty($menu['customname2']['name'])}{$menu['customname2']['name']}{else}自定义{/if}"  />
                            {else}
                            <div class="form-control valid">{php echo empty($menu['customname2']['name'])?'自定义':$menu['customname2']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">类型</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype2]' data-tab="customname2" value="0" {if empty($menu['customname2']['type'])}checked{/if} /> 文本</label>
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype2]' data-tab="customname2" value="1" {if $menu['customname2']['type']==1}checked{/if} /> 链接</label>
                            {else}
                            <div class='form-control-static'>{if empty($menu['customname2']['type'])}文本{elseif $menu['customname2']['type']==1}链接{/if}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname2-type-url" style="{if $menu['customname2']['type']==1}display: block;{else}display:none;{/if}">
                    <label class="col-sm-2 control-label">链接</label>
                    <div class="col-sm-10">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customurl2]" class="form-control input-sm diy-bind" placeholder="请选择链接或输入链接地址" value="{$menu['customname2']['url']}" id="shareurl2" />
                            <span data-input="#shareurl2" data-toggle="selectUrl" data-full="true" class="input-group-addon btn btn-default">选择链接</span>
                            {else}
                            <div class='form-control-static'>{$menu['customname2']['url']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname2-type-content" style="{if $menu['customname2']['type']==1}display: none;{else}display:block;{/if}">
                    <label class="col-sm-2 control-label">内容</label>
                    <div class="col-sm-10 col-xs-12">
                        {ife 'live.room' $item}
                        {php echo tpl_ueditor('dtab[customintroduce2]',$menu['customname2']['introduce'],array('height'=>'358'))}
                        {/if}
                    </div>
                </div>
            </div>
            <!--自定义菜单2end-->
            <!--自定义菜单3start-->
            <div class="inner live-menu-customname3" style="{if $nestables[0]=='customname3'}display: block;{/if}">
                <div class="form-group">
                    <label class="col-sm-2 control-label">名称</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customname3]" data-tab="customname3" class="live-name form-control" value="{if !empty($menu['customname3']['name'])}{$menu['customname3']['name']}{else}自定义{/if}"  />
                            {else}
                            <div class="form-control valid">{php echo empty($menu['customname3']['name'])?'自定义':$menu['customname3']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">类型</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype3]' data-tab="customname3" value="0" {if empty($menu['customname3']['type'])}checked{/if} /> 文本</label>
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype3]' data-tab="customname3" value="1" {if $menu['customname3']['type']==1}checked{/if} /> 链接</label>
                            {else}
                            <div class='form-control-static'>{if empty($menu['customname3']['type'])}文本{elseif $menu['customname3']['type']==1}链接{/if}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname3-type-url" style="{if $menu['customname3']['type']==1}display: block;{else}display:none;{/if}">
                    <label class="col-sm-2 control-label">链接</label>
                    <div class="col-sm-10">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customurl3]" class="form-control input-sm diy-bind" placeholder="请选择链接或输入链接地址" value="{$menu['customname3']['url']}" id="shareurl3" />
                            <span data-input="#shareurl3" data-toggle="selectUrl" data-full="true" class="input-group-addon btn btn-default">选择链接</span>
                            {else}
                            <div class='form-control-static'>{$menu['customname3']['url']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname3-type-content" style="{if $menu['customname3']['type']==1}display: none;{else}display:block;{/if}">
                    <label class="col-sm-2 control-label">内容</label>
                    <div class="col-sm-10 col-xs-12">
                        {ife 'live.room' $item}
                        {php echo tpl_ueditor('dtab[customintroduce3]',$menu['customname3']['introduce'],array('height'=>'358'))}
                        {/if}
                    </div>
                </div>
            </div>
            <!--自定义菜单3end-->
            <!--自定义菜单4start-->
            <div class="inner live-menu-customname4" style="{if $nestables[0]=='customname4'}display: block;{/if}">
                <div class="form-group">
                    <label class="col-sm-2 control-label">名称</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customname4]" data-tab="customname4" class="live-name form-control" value="{if !empty($menu['customname4']['name'])}{$menu['customname4']['name']}{else}自定义{/if}"  />
                            {else}
                            <div class="form-control valid">{php echo empty($menu['customname4']['name'])?'自定义':$menu['customname4']['name']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label">类型</label>
                    <div class="col-sm-4">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype4]' data-tab="customname4" value="0" {if empty($menu['customname4']['type'])}checked{/if} /> 文本</label>
                            <label class="radio-inline"><input type="radio" class="customname" name='dtab[customtype4]' data-tab="customname4" value="1" {if $menu['customname4']['type']==1}checked{/if} /> 链接</label>
                            {else}
                            <div class='form-control-static'>{if empty($menu['customname4']['type'])}文本{elseif $menu['customname4']['type']==1}链接{/if}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname4-type-url" style="{if $menu['customname4']['type']==1}display: block;{else}display:none;{/if}">
                    <label class="col-sm-2 control-label">链接</label>
                    <div class="col-sm-10">
                        <div class="input-group input-group-sm">
                            {ife 'live.room' $item}
                            <input type="text" name="dtab[customurl4]" class="form-control input-sm diy-bind" placeholder="请选择链接或输入链接地址" value="{$menu['customname4']['url']}" id="shareurl4" />
                            <span data-input="#shareurl4" data-toggle="selectUrl" data-full="true" class="input-group-addon btn btn-default">选择链接</span>
                            {else}
                            <div class='form-control-static'>{$menu['customname4']['url']}</div>
                            {/if}
                        </div>
                    </div>
                </div>
                <div class="form-group customname4-type-content" style="{if $menu['customname3']['type']==1}display: none;{else}display:block;{/if}">
                    <label class="col-sm-2 control-label">内容</label>
                    <div class="col-sm-10 col-xs-12">
                        {ife 'live.room' $item}
                        {php echo tpl_ueditor('dtab[customintroduce4]',$menu['customname4']['introduce'],array('height'=>'358'))}
                        {/if}
                    </div>
                </div>
            </div>
            <!--自定义菜单4end-->
        </div>
    </div>
</div>
<script type="text/javascript">
    require(['jquery.ui'],function(){
        $(function () {
            $( "#sortable").sortable();
            $( "#sortable a").disableSelection();
            $(".menu-add").off("click").on("click",function (event) {
                event.stopPropagation();
                var total = $("#sortable a").length;
                var goodsshow = $("input[name='dtab[goodstitleshow]']").val();
                var introducetitleshow = $("input[name='dtab[introducetitleshow]']").val();
                var nestable = "";
                var id = parseInt({$_GPC['id']});
                $("#sortable a").each(function () {
                    nestable += $(this).attr('data-tab')+","
                });
                if(goodsshow>0){
                    total = total - 1;
                }
                if(introducetitleshow>0){
                    total = total - 1;
                }
                if(total>=5){
                    tip.msgbox.err('最多使用5个菜单!');
                    return;
                }
                var html = '';
                $.ajax({
                    type: "GET",
                    url: "{php echo webUrl('live/room/menu_add');}",
                    data: {id:id,nestable:nestable},
                    dataType: "json",
                    success: function(data){
                        if(data.result.statu==0){
                            tip.msgbox.err(data.result.message)
                            return;
                        }else{
                            console.log(data);
                            var menu = data.result.menu;
                            html += "<a href='javascript:void(0);' data-tab='"+menu+"' class='nestable-list "+menu+"'>";
                            html += "<input type='hidden' name='nestable[]' value='"+menu+"'>自定义";
                            html += "<span><i class='fa fa-close'></i></span></a>";
                            $("#sortable").append(html);
                            /*
                             * 菜单删除绑定事件
                             * */
                            $(".nestable-list").mouseenter(function () {
                                $(this).find("span").show();
                            }).mouseleave(function () {
                                $(this).find("span").hide();
                            });
                            $(".nestable-list .fa-close").off("click").on("click",function (event) {
                                event.stopPropagation();
                                var obj = $(this).parents(".nestable-list");
                                if(confirm("菜单删除后不可恢复，确定删除该菜单?")){
                                    obj.remove();
                                }
                            });
                            $(".block-tab a,.live-menu-ul a:not('.add')").off("click").on("click",function () {
                                var _this = $(this);
                                var tab = _this.attr("data-tab");
                                if(tab!=''){
                                    $(".diy-editor-group .inner").hide();
                                    $(".block-tab a").removeClass("active");
                                    _this.addClass("active");
                                    $(".live-menu-"+tab+"").show();
                                }
                            });
                            /*
                             *
                             * */
                            $(".diy-editor-group .inner").hide();
                            $(".block-tab a").removeClass("active");
                            $(".nestable-list."+menu+"").addClass("active");
                            $(".live-menu-"+menu+"").show();

                        }
                    }
                });

            });
            $(".live-name").change(function () {
                var name = $(this).attr("data-tab");
                $("a."+name+"").html("<input type='hidden' name='nestable[]' value='"+name+"'>"+$(this).val());
            });
            /*
             * 菜单类型
             * */
            $("input.customname").off("click").on("click",function () {
                var _this = $(this);
                var tab = _this.attr('data-tab');
                if(_this.val()==0){
                    $("."+tab+"-type-content").show();
                    $("."+tab+"-type-url").hide();
                }else{
                    $("."+tab+"-type-url").show();
                    $("."+tab+"-type-content").hide();
                }
            });

            /*
             * 菜单删除
             * */
            $(".nestable-list .fa-close").off("click").on("click",function (event) {
                event.stopPropagation();
                var obj = $(this).parents(".nestable-list");
                if(confirm("菜单删除后不可恢复，确定删除该菜单?")){
                    obj.find("input").remove();
                    obj.hide();
                }
            });
            /*
             * 菜单选项卡切换
             * */
            $(".block-tab a,.live-menu-ul a:not('.add')").off("click").on("click",function () {
                var _this = $(this);
                var tab = _this.attr("data-tab");
                if(tab!=''){
                    $(".diy-editor-group .inner").hide();
                    $(".block-tab a").removeClass("active");
                    _this.addClass("active");
                    $(".live-menu-"+tab+"").show();
                }
            });
            $(".nestable-list").mouseenter(function () {
                $(this).find("span").show();
            }).mouseleave(function () {
                $(this).find("span").hide();
            });
            $("input[name='dtab[goodstitleshow]']").off("click").on("click",function () {
                if($(this).val()==0){
                    $(this).attr("checked",false).val(1);
                    $(".block-tab a.goods").hide();
                    $(".live-menu-ul a.goods").parent("li").show();
                }else{
                    $(this).attr("checked","true").val(0);
                    $(".block-tab a.goods").show();
                    $(".live-menu-ul a.goods").parent("li").hide();
                }
            });
            $("input[name='dtab[introducetitleshow]']").off("click").on("click",function () {
                if($(this).val()==0){
                    $(this).attr("checked",false).val(1);
                    $(".block-tab a.introduce").hide();
                    $(".live-menu-ul a.introduce").parent("li").show();
                }else{
                    $(this).prop("checked",true).val(0);
                    $(".block-tab a.introduce").show();
                    $(".live-menu-ul a.introduce").parent("li").hide();
                }
            });

        })
        function menu_total() {
            if($("#menu_tab1").css("display")!="none" && $("#menu_tab2").css("display")!="none"){
                $(".menu-add").hide();
            }
        };
    })

</script>

<!--4000097827-->